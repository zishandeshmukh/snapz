# Mobile Share Integration (mobile side)

This document explains how to implement the mobile share action that posts shared content to your backend `POST /mobile/share` endpoint so that shared items are processed by the same AI pipeline and saved to Supabase.

Summary
- The backend endpoint: `POST http://<SERVER_HOST>:3001/mobile/share` (or your deployed URL).
- Payload (JSON): { url?: string, title?: string, description?: string, metadata?: object }
- The backend will analyze the combined text using the same AI pipeline as the web extension and insert into `content_documents.metadata`.

Environment and secrets
- The backend server requires API keys and secrets (OpenAI/Groq, Supabase) — these are already present in `Backend/Server/.env` on the server side. Do NOT include secret keys in the mobile app. The mobile only needs the backend base URL and an optional client API key if you secure the endpoint.

API Key (optional)
- The backend supports a simple header-based API key for the mobile share endpoint. If you set `MOBILE_API_KEY` in `Backend/Server/.env`, send it in header `x-api-key` with each POST to `/mobile/share`.

Example header (JS):

```js
fetch('https://your-server/mobile/share', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'x-api-key': 'your-mobile-api-key'
  },
  body: JSON.stringify(payload)
});
```

Example payload

```json
{
  "url": "https://www.linkedin.com/posts/example-post",
  "title": "Post Title Example",
  "description": "A short snippet or description captured from the share.",
  "metadata": {
    "author": "Jane Doe",
    "platform": "linkedin",
    "sharedAt": "2025-10-30T12:00:00Z"
  }
}
```

Recommended mobile implementation approaches

- React Native (cross-platform): use a native share extension plugin (e.g. `react-native-share-extension`) to capture shared content then send a fetch POST to `/mobile/share`.
- Native iOS (Swift): implement a Share Extension target that collects the item provider data (title, url, text) and posts to the backend.
- Native Android (Kotlin/Java): implement an `Intent` receiver (share target) to capture `Intent.ACTION_SEND` and POST the payload.

Security
- Consider requiring an API key or signed token from the mobile app to protect the endpoint. Mobile apps can still be reverse-engineered — rotate keys periodically and use rate-limiting.

Sample JS sender (React Native / plain JS)
- See `ShareSender.example.js` in this folder for a simple fetch-based sender that mobile can call after collecting share data.

Native snippets (concept)
- iOS (Swift share extension): gather `NSExtensionItem` contents (title, text, URL), then send via `URLSession` as JSON to `/mobile/share`.
- Android (Kotlin share receiver): in `onCreate`, read `intent.getStringExtra(Intent.EXTRA_TEXT)` for text or URL and POST with `HttpUrlConnection` or `OkHttp`.

What to test
- Verify a POST to `/mobile/share` returns the structured JSON including `title`, `summary`, `keywords`, `emotions`, `timestamp`, `source_url`.
- Verify the record appears in Supabase `content_documents` table (metadata JSON).

Contact
- If you want, I can scaffold a small React Native example app + share extension skeleton or provide full native snippets. Tell me which platform(s) you want me to scaffold (iOS, Android, or React Native) and I will add example code.
